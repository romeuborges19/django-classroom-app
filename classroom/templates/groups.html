{% extends 'base/header.html' %}

{% load static %}

{% block title %} Groups {% endblock title %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'classroom/css/groups.css' %}">
{% endblock extra_css %}

{% block content %}
<main>
	<div class="main-container">
		<div class="main-title-container">
			<p> Lista de grupos </p>
		</div>

		<div class="groups-container">
			{% for group in object_list %}
				<div class="group-container">
					<div class="group-info-container">
						<b>{{ group.name }}</b>
					</div>
					<a class="button-container" href="{% url 'classroom:group' group.pk %}"> Ver grupo </a>
				<button class="button-container remove-button" data-update-url="{% url 'classroom:delete_group' %}" data-group-id="{{group.pk}}"> Deletar </button>
				</div>
			{% endfor %}
		</div>
	</div>
</main>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'classroom/js/cookie.js' %}"></script>
<script>
$(document).ready(function() {
	$('.remove-button').click(function() {
		const csrftoken = getCookie('csrftoken');
		const groupId = $(this).data('group-id');
		const updateUrl = $(this).data('update-url');

	$.ajax({
		url: updateUrl,
		method: 'POST',
		headers: {'X-CSRFToken': csrftoken},
		data: {'group_id': groupId},
		mode: 'same-origin',
		success: function(response) {
				if(response.status == 'error') {
					alert(response.error)
				} else {
					location.reload();
				}
			}
	
		})
	})
})
</script>
{% endblock content %}
