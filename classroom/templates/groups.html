{% extends 'base/header.html' %}

{% load static %}

{% block title %} Groups {% endblock title %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'classroom/css/groups.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'classroom/css/styles.css' %}">
{% endblock extra_css %}

{% block content %}
<main>
	<div class="main-container">
		
		<div class="main-title-container">
			<p> Lista de grupos </p>
		</div>

		<div class="return-button-container-container">
			<div class="return-button-container">
				<a class="return-button" href="{% url 'classroom:home' %}"> Voltar </a>
			</div>
		</div>
		<div class="groups-container">
			<div class="groups-button-container">
				<div class="groups-button">
					<a href={% url 'classroom:create_group' %}> Criar novo grupo </a>
				</div>
			</div>
			{% for group in object_list %}
				<div class="group-container">
					<div class="group-info-container">
						<b>{{ group.name }}</b>
					</div>
					<div class="buttons-container">
						<a class="" href="{% url 'classroom:group' group.pk %}"> 
							<svg xmlns="http://www.w3.org/2000/svg" width="30" height="20" viewBox="0 0 82 55" fill="none">
							  <path d="M81.4757 25.6341C73.7896 10.6377 58.5735 0.491211 41.1507 0.491211C23.7278 0.491211 8.50742 10.6447 0.825662 25.6355C0.501443 26.2769 0.33252 26.9854 0.33252 27.7041C0.33252 28.4227 0.501443 29.1313 0.825662 29.7726C8.51167 44.7691 23.7278 54.9155 41.1507 54.9155C58.5735 54.9155 73.7939 44.762 81.4757 29.7712C81.7999 29.1299 81.9688 28.4213 81.9688 27.7026C81.9688 26.984 81.7999 26.2754 81.4757 25.6341ZM41.1507 48.1125C37.1141 48.1125 33.1682 46.9155 29.812 44.6729C26.4557 42.4303 23.8398 39.2429 22.2951 35.5136C20.7504 31.7843 20.3462 27.6807 21.1337 23.7217C21.9212 19.7628 23.865 16.1262 26.7192 13.2719C29.5735 10.4177 33.2101 8.47389 37.169 7.6864C41.128 6.89891 45.2316 7.30308 48.9609 8.8478C52.6902 10.3925 55.8776 13.0084 58.1202 16.3647C60.3628 19.7209 61.5598 23.6668 61.5598 27.7034C61.5611 30.3839 61.0341 33.0384 60.0089 35.5151C58.9837 37.9919 57.4804 40.2423 55.585 42.1377C53.6896 44.0331 51.4392 45.5364 48.9624 46.5616C46.4857 47.5868 43.8312 48.1138 41.1507 48.1125ZM41.1507 14.0973C39.9362 14.1143 38.7296 14.2949 37.5635 14.6344C38.5247 15.9407 38.986 17.5482 38.8636 19.1655C38.7413 20.7827 38.0434 22.3025 36.8966 23.4493C35.7498 24.5961 34.23 25.294 32.6128 25.4163C30.9955 25.5387 29.388 25.0774 28.0817 24.1162C27.3379 26.8566 27.4722 29.7614 28.4657 32.4215C29.4592 35.0817 31.2618 37.3633 33.62 38.9453C35.9781 40.5273 38.773 41.3299 41.6112 41.2403C44.4494 41.1506 47.1881 40.1732 49.4417 38.4455C51.6953 36.7178 53.3504 34.327 54.174 31.6094C54.9976 28.8918 54.9482 25.9844 54.0329 23.2964C53.1176 20.6083 51.3823 18.275 49.0714 16.6248C46.7605 14.9746 43.9903 14.0906 41.1507 14.0973Z" fill="black"/>
							</svg>
						</a>
						<a class="" href="{% url 'classroom:update_group' group.pk %}"> 
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 82 82" fill="none">
							  <path d="M79.388 22.6463L72.0372 29.9971C71.2878 30.7466 70.0759 30.7466 69.3265 29.9971L51.6272 12.2978C50.8777 11.5484 50.8777 10.3366 51.6272 9.58712L58.978 2.23633C61.9597 -0.745444 66.8071 -0.745444 69.8048 2.23633L79.388 11.8195C82.3857 14.8012 82.3857 19.6486 79.388 22.6463ZM45.3128 15.9015L3.44041 57.7739L0.060003 77.1474C-0.402411 79.7625 1.87777 82.0267 4.4928 81.5803L23.8664 78.1839L65.7388 36.3115C66.4882 35.5621 66.4882 34.3502 65.7388 33.6008L48.0395 15.9015C47.2741 15.152 46.0623 15.152 45.3128 15.9015ZM19.7844 54.1862C18.9074 53.3092 18.9074 51.906 19.7844 51.029L44.3402 26.4732C45.2172 25.5962 46.6203 25.5962 47.4973 26.4732C48.3743 27.3502 48.3743 28.7534 47.4973 29.6304L22.9415 54.1862C22.0645 55.0632 20.6614 55.0632 19.7844 54.1862ZM14.0281 67.5962H21.6819V73.3844L11.3971 75.1862L6.43813 70.2272L8.23995 59.9424H14.0281V67.5962Z" fill="black"/>
							</svg>
						</a>
						<button onclick="document.getElementById('delete-message-' + {{ group.id }}).style.display='block'" class="remove-button-style"> 
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 82 94" fill="none">
							  <path d="M5.83116 84.5519C5.83116 86.8717 6.75269 89.0964 8.39302 90.7368C10.0334 92.3771 12.2581 93.2986 14.5779 93.2986H67.0584C69.3781 93.2986 71.6029 92.3771 73.2432 90.7368C74.8836 89.0964 75.8051 86.8717 75.8051 84.5519V23.3247H5.83116V84.5519ZM55.396 37.9026C55.396 37.1293 55.7032 36.3877 56.25 35.841C56.7968 35.2942 57.5384 34.987 58.3116 34.987C59.0849 34.987 59.8265 35.2942 60.3732 35.841C60.92 36.3877 61.2272 37.1293 61.2272 37.9026V78.7207C61.2272 79.494 60.92 80.2356 60.3732 80.7824C59.8265 81.3291 59.0849 81.6363 58.3116 81.6363C57.5384 81.6363 56.7968 81.3291 56.25 80.7824C55.7032 80.2356 55.396 79.494 55.396 78.7207V37.9026ZM37.9026 37.9026C37.9026 37.1293 38.2097 36.3877 38.7565 35.841C39.3033 35.2942 40.0449 34.987 40.8181 34.987C41.5914 34.987 42.333 35.2942 42.8798 35.841C43.4265 36.3877 43.7337 37.1293 43.7337 37.9026V78.7207C43.7337 79.494 43.4265 80.2356 42.8798 80.7824C42.333 81.3291 41.5914 81.6363 40.8181 81.6363C40.0449 81.6363 39.3033 81.3291 38.7565 80.7824C38.2097 80.2356 37.9026 79.494 37.9026 78.7207V37.9026ZM20.4091 37.9026C20.4091 37.1293 20.7162 36.3877 21.263 35.841C21.8098 35.2942 22.5514 34.987 23.3246 34.987C24.0979 34.987 24.8395 35.2942 25.3863 35.841C25.9331 36.3877 26.2402 37.1293 26.2402 37.9026V78.7207C26.2402 79.494 25.9331 80.2356 25.3863 80.7824C24.8395 81.3291 24.0979 81.6363 23.3246 81.6363C22.5514 81.6363 21.8098 81.3291 21.263 80.7824C20.7162 80.2356 20.4091 79.494 20.4091 78.7207V37.9026ZM78.7207 5.83119H56.8538L55.1409 2.42361C54.7781 1.6951 54.2191 1.0823 53.527 0.65414C52.8349 0.225979 52.037 -0.000551767 51.2231 3.19488e-05H30.3949C29.5829 -0.00308964 28.7864 0.222597 28.0967 0.651234C27.407 1.07987 26.8521 1.69412 26.4953 2.42361L24.7824 5.83119H2.91558C2.14232 5.83119 1.40073 6.13837 0.853954 6.68515C0.307176 7.23193 0 7.97352 0 8.74678L0 14.5779C0 15.3512 0.307176 16.0928 0.853954 16.6396C1.40073 17.1863 2.14232 17.4935 2.91558 17.4935H78.7207C79.4939 17.4935 80.2355 17.1863 80.7823 16.6396C81.3291 16.0928 81.6363 15.3512 81.6363 14.5779V8.74678C81.6363 7.97352 81.3291 7.23193 80.7823 6.68515C80.2355 6.13837 79.4939 5.83119 78.7207 5.83119Z" fill="black"/>
							</svg>
						</button>
					</div>
				</div>
			<div id="delete-message-{{ group.id }}" class="modal">
				<div class="container">
				  <h1>Deletar grupo</h1>
					<p>Tem certeza de que deseja deletar o grupo {{ group.name}}?</p>

				  <div class="clearfix">
						<button onclick="document.getElementById('delete-message-' + {{ group.id }}).style.display='none'" class="button-container btn">Cancelar</button>
					<button type="button" class="remove-button remove-button-style button-container" data-update-url="{% url 'classroom:delete_group' %}" data-group-id="{{group.pk}}">Deletar</button>
				  </div>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>


</main>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'classroom/js/cookie.js' %}"></script>
<script>
$(document).ready(function() {

	$('.remove-button').click(function() {
		const csrftoken = getCookie('csrftoken');
		const groupId = $(this).data('group-id');
		const updateUrl = $(this).data('update-url');

	$.ajax({
		url: updateUrl,
		method: 'POST',
		headers: {'X-CSRFToken': csrftoken},
		data: {'group_id': groupId},
		mode: 'same-origin',
		success: function(response) {
				if(response.status == 'error') {
					alert(response.error)
				} else {
					location.reload();
				}
			}
	
		})
	})
})
</script>
{% endblock content %}
